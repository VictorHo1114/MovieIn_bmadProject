========================================================================
 Feature Buttons 評分權重修復完成
========================================================================

問題描述:
----------
智能混合推薦系統在評分判斷時，只考慮了自然語言輸入，
忽略了用戶點選的 Feature Label Buttons (selected_moods, selected_genres)。

這導致即使用戶明確選擇了多個 mood/genre buttons，
系統仍可能誤判為需要 Embedding。

修復內容:
----------
1. should_use_embedding() 函數新增兩個參數:
   - selected_moods: List[str]  (用戶選擇的 mood buttons)
   - selected_genres: List[str] (用戶選擇的 genre buttons)

2. 新增評估維度 - Feature Buttons 明確度 (-25/-15/0):
   - 3+ 個 buttons: -25 分 (明確選擇，適合 Feature)
   - 1-2 個 buttons: -15 分
   - 0 個 buttons: 0 分

3. 優化抽象詞檢測邏輯:
   - 只在有自然語言輸入時才檢測抽象詞
   - 純 Button 選擇（無自然語言）: -20 分 (適合 Feature)

4. recommend_movies_hybrid() 調用更新:
   - 傳遞 selected_moods 和 selected_genres 到評分函數

評分系統更新 (總分 100  125):
----------
原有評估項目:
1. Keywords 覆蓋度: -30/-15/0
2. Mood Tags 覆蓋度: -20/-10/0
3. 抽象詞檢測: -20/-5/+10
4. Feature 匹配分數: -15/-10/0
5. 候選數量: -15/-10/0

新增評估項目:
2.5. Feature Buttons 明確度: -25/-15/0  NEW!
     (用戶點選 buttons = 明確 feature 選擇)

測試案例變化:
----------
案例: 用戶選擇 2 個 mood buttons + 1 個 genre button，無自然語言輸入

修復前:
  - Keywords: 0 個 (0)
  - Mood Tags: 8 個 (-20)
  - 抽象詞: 0 個 (-20)
  - Feature 分數: 45.0 (-15)
  - 候選數量: 80 部 (-15)
   總分: 30/100 < 40  Feature 路徑 

修復後:
  - Keywords: 0 個 (0)
  - Mood Tags: 8 個 (-20)
  - Feature Buttons: 3 個 (-25)  NEW!
  - 抽象詞: 僅 Button 選擇 (-20)
  - Feature 分數: 45.0 (-15)
  - 候選數量: 80 部 (-15)
   總分: 5/100 < 40  Feature 路徑 
  (更明確地選擇 Feature 路徑)

預期效果:
----------
 用戶點選多個 buttons  更傾向使用 Feature 路徑
 用戶只輸入自然語言  正常評分（不受影響）
 混合場景 (buttons + 自然語言)  綜合評估兩個來源

驗證結果:
----------
 無編譯錯誤
 函數簽名更新完成
 調用處已更新

下一步:
----------
1.  Feature Buttons 評分權重 - 已完成
2.  測試智能混合推薦功能 (P0)
3.  修改 API 路由使用新函數
4.  前端整合測試
5.  閾值實驗與優化

========================================================================
